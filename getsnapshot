#!/bin/sh

MIRRORS='http://www.openbsd.org/ftp.html'
I='getsnapshot'
VERSION='0.2'
arch=`uname -m`

# Uncomment if not debugging
wget -q $MIRRORS

servers=`grep 'ftp://' ftp.html | \
    sed 's/^[[:space:]]//; s/<a href=.*//; s/<\/a>//' | \
    sed 'N; s/\n//'`

# Uncomment if not debugging
if [ -e ftp.html ]; then
    rm -fr ftp.html
fi

# presentation
#echo "$I v$VERSION"
#echo "\$release=$release" #debug only
echo 'Servers available: '

# no CVS, so left here for (MY) reference
#let i=0
#for each in $servers; do
#    i=$((i + 1))
#    server[$i]=$each
#    echo "$i) $each"
#done

PS3='Server? '
select server in $servers; do
    if [ $server ]; then
        wget -cr -R install*.iso \
	    ${server[$chosen]}snapshots/$arch \
	    ${server[$chosen]}snapshots/ports.tar.gz
	
        echo 'Finished.'
        break
    else
        echo 'Invalid selection.'
    fi
done


